<!DOCTYPE html>

<html>
    
    <head>
        
        <title>Escape the Ship</title>
        
        <link href="css/layoutEngineStairs.css" rel="stylesheet" type="text/css" />
        
        <script type="text/javascript">
        
            window.addEventListener('load', function() { te = setInterval(countDown, 1000);});
            var timer = 79;
            var te;
            var countContrast = 0;
            var countFontSize = 0;
            var countDoor = 0;
            var door = new Audio();
            door.src = "sound/waterdoor.mp3";
            var name = sessionStorage.getItem('fName');
            var timeTaken = 0;
            var level = 1;
            var name = sessionStorage.getItem('transferName');
            
            function initialEngine() {
                
                initialOutputEngine();
                recieveMain();
                setSize();
                setContrast();
                
                setTimeout(timerHint, 20000);
                
            } 
            
            function timerHint() {
                
               document.getElementById("outputText").innerHTML += "<span class = 'player'><br><br>[" + name + "]: I can't waste time like this! I need to think...</span>"; 
                
            }
            
            function recieveMain() {
                
                
                countContrast = sessionStorage.getItem('transferContrast');
                
                
                
                
                countFontSize = sessionStorage.getItem('transferSize');
                
                
                
                
            }
               
            function initialOutputEngine() {
                
                
                
                document.getElementById("outputText").innerHTML += "<span class = 'player'>[" + name + "]: I can hear water flowing in, which is usually not good for a ship - explains what the alarm is about anyway.</span>";
                
                 

                

            }
            
            function countDown() {
                
                if(timer > 0) {

                    document.getElementById('timeLeft').innerHTML = timer;
                    timer--;
                    timeTaken++;

                } else {
                    
                    var PageId = level;
                    
                    sessionStorage.setItem('PageId', PageId);
                    
                    var transferContrast = countContrast;
                
                    sessionStorage.setItem('transferContrast', transferContrast);
                
                    var transferSize = countFontSize;
                
                    sessionStorage.setItem('transferSize', transferSize);

                    window.open('GameSummaryLose.html', '_self'); 

                }
                 
             }    

            function arrowOutput() {
                
                document.getElementById('outputText').innerHTML += "<span class = 'player'><br><br>[" + name + "]: An exit sign - I should probably go to where it is pointing.</span>"
                
            }

            function closeDoor() {


            if(countDoor < 1) {
                
                var image = document.getElementById('engine');
                image.src = 'images/engine2.png';
                
                door.play();
                document.getElementById("outputText").innerHTML += "<span class = 'system'><br><br>[System]: You've managed to close a water tight door, buying you some more time!</span>";
                timer += 60;
                countDoor++;
                
               
                
            } else {
                
            document.getElementById("outputText").innerHTML += "<span class = 'system'><br><br>[System]: You have already closed this door!</span>";
               
                
                    
            }
                
            }

            function changeColour() {
                    
            
            countContrast++;  
                
            
             if(countContrast % 2 === 0) {
                    
            document.getElementById("head").style.color = "aqua";
            document.getElementById("accessibility").style.color = "aqua";
            document.getElementById("output").style.color = "aqua";
            document.getElementById("audio").style.color = "aqua";
            document.getElementById("timer").style.color = "aqua";
            document.getElementById("buttonContrast").style.color = "aqua";
            document.getElementById("buttonFont").style.color = "aqua";
                
                
                
                    
                    
            } else if (countContrast % 2 === 1) {
                           
            document.getElementById("head").style.color = "yellow";
            document.getElementById("accessibility").style.color = "yellow";
            document.getElementById("output").style.color = "yellow";
            document.getElementById("audio").style.color = "yellow";
            document.getElementById("timer").style.color = "yellow";
            document.getElementById("buttonContrast").style.color = "yellow";
            document.getElementById("buttonFont").style.color = "yellow";    
                
               
             
                           
                }
            
            
                  
            }
            
            function changeFontSize() {
                    
            
            countFontSize++;  
                
            
             if(countFontSize % 2 === 0) {
                    
            document.getElementById("head").style.fontSize = "initial";
            document.getElementById("accessibility").style.fontSize = "initial";
            document.getElementById("output").style.fontSize = "initial";
            document.getElementById("audio").style.fontSize = "initial";
            document.getElementById("timer").style.fontSize = "initial";
            document.getElementsByTagName("button").style.fontSize = "initial";
                
                
                
                    
                    
            } else if (countFontSize % 2 === 1) {
                           
            document.getElementById("head").style.fontSize = "x-large";
            document.getElementById("accessibility").style.fontSize = "x-large";
            document.getElementById("output").style.fontSize = "x-large";
            document.getElementById("audio").style.fontSize = "x-large";
            document.getElementById("timer").style.fontSize = "x-large";
                
                
               
             
                           
                }
            
            
                  
            }
            
            function sendEngine() {
                
                var transferContrast = countContrast;
                
                sessionStorage.setItem('transferContrast', transferContrast);
                
                var transferSize = countFontSize;
                
                sessionStorage.setItem('transferSize', transferSize);
                
                var transferTime = timer;
                
                sessionStorage.setItem('timeLeft', transferTime);
                
                var timeTakenEngine = timeTaken;
                
                sessionStorage.setItem('timeTakenEngine', timeTakenEngine)
                
                
                
                window.open('stairs.html', '_self'); 
 
            }
             
            function setSize() {

            if (countFontSize % 2 === 1) {
                           
            document.getElementById("head").style.fontSize = "x-large";
            document.getElementById("accessibility").style.fontSize = "x-large";
            document.getElementById("output").style.fontSize = "x-large";
            document.getElementById("audio").style.fontSize = "x-large";
            document.getElementById("timer").style.fontSize = "x-large";
     
            }
                
            }
            
            function setContrast() {

                
            if(countContrast % 2 === 1) {
                    
            document.getElementById("head").style.color = "yellow";
            document.getElementById("accessibility").style.color = "yellow";
            document.getElementById("output").style.color = "yellow";
            document.getElementById("audio").style.color = "yellow";
            document.getElementById("timer").style.color = "yellow";
            document.getElementById("buttonContrast").style.color = "yellow";
            document.getElementById("buttonFont").style.color = "yellow";
                
      
            }
            
            }
            
            function hallOutput() {
                
                if(countDoor > 0) {
                    
                } else {
                
              document.getElementById("outputText").innerHTML += "<span class = 'player'><br><br>[" + name + "]: Unless I want to drown, I should get out of here or seal off this hallway.</span>"; 
                    
                }
                
            }

        </script>

    </head>

        <body onload="initialEngine()">
        
            <div id="head">
            <h1>Level 1 - Engine Room</h1>
        </div>
        
                <div id="wrapper">

                    <div class="row">

                        <div id="game">
                    
                        <img id ="engine" src="images/Engine%20Room.png" alt="engine room"  usemap="#valve">

                            <map name="valve">    
                    
                                <area shape="rect" coords="440,270,475,310" onclick="closeDoor()">
                                
                                <area shape="rect" coords="455,265,480,240" onclick="arrowOutput()">
                            
                                <area shape="rect" coords="480,170,540,400" onclick="sendEngine()">
                                
                                <area shape="rect" coords="440,240,370,380" onclick="hallOutput()">
                        
                            </map> 
                    

                    </div>
                        
                    <div id = "timer">
                    
                        <h2>Time Remaining: <span id = "timeLeft">80</span></h2>
                         
                    </div>

                    <div id = "audio">
                    
                        <h2>Sound Effects:</h2>
                        
                         <figcaption>Alarm</figcaption>
                        
                        <audio controls loop>
                        
                            <source src="sound/emergency-alarm-bell-ringing.mp3">
                        
                            Your browser does not support the audio element.
                        
                        </audio>
                    
                    <figcaption>Engines</figcaption>
                    <audio controls loop>   
                        
                            <source src="sound/Engines.mp3">
                        
                            Your browser does not support the audio element.
                        
                        </audio>    
                        
                    <figcaption>Running Water</figcaption>
                        
                        <audio controls loop>
                        
                            <source src="sound/zapsplat_nature_cave_canern_ambience_distant_water_running_dripping_55312.mp3">
                        
                            Your browser does not support the audio element.
                        
                        </audio>
                    
                       

                    </div>
                
                    </div>

                    <div class="row">
 
                        <div id = "output">
                       
                        <p id="outputText"></p>
                        
                    
                    </div>

                        <div id = "accessibility" >
                    
                    <h2>Accessibility Options:</h2>
                    
                        <button id = "buttonContrast" onclick="changeColour()">Toggle High Contrast</button>
                    
                        <button id = "buttonFont" onclick="changeFontSize()">Toggle Font Size</button>


                    </div>

                    </div>

                </div>
        
        </body>
    
</html>